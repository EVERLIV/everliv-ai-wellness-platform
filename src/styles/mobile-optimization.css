
@layer components {
  /* Mobile PWA Safe Area Support */
  .safe-area-top {
    padding-top: env(safe-area-inset-top);
  }

  .safe-area-bottom {
    padding-bottom: env(safe-area-inset-bottom);
  }

  .safe-area-inset {
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }

  .safe-area-all {
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }

  /* Chat Mobile Optimization */
  .chat-mobile-optimized {
    @apply h-full flex flex-col;
    /* Safe area support for iPhone X+ */
    padding-bottom: env(safe-area-inset-bottom);
    padding-top: env(safe-area-inset-top);
  }
  
  .chat-header-mobile {
    @apply flex items-center justify-between p-3 sm:p-4 border-b border-border bg-muted/30;
    @apply overflow-x-auto scrollbar-hide;
    min-height: 60px;
  }
  
  .chat-messages-mobile {
    @apply flex-1 overflow-y-auto px-3 sm:px-6 py-4;
    @apply pb-20 sm:pb-6;
    scroll-behavior: smooth;
    /* Prevent content jumping */
    overscroll-behavior: contain;
  }
  
  .chat-message-mobile {
    @apply flex items-start space-x-3 mb-4;
    max-width: 85%;
  }
  
  .chat-avatar-mobile {
    @apply w-8 h-8 sm:w-9 sm:h-9 border flex items-center justify-center flex-shrink-0;
  }
  
  .chat-input-fixed {
    @apply fixed bottom-0 left-0 right-0 sm:relative sm:bottom-auto;
    @apply border-t-2 border-border bg-card p-3 sm:p-6 z-50;
    /* Safe area support */
    padding-bottom: calc(1rem + env(safe-area-inset-bottom));
  }
  
  .chat-input-mobile {
    @apply w-full min-h-[44px] p-3 resize-none border border-input bg-background;
    @apply text-sm placeholder:text-muted-foreground overflow-hidden;
    @apply focus:border-ring focus:outline-none;
    line-height: 1.4;
    word-break: break-word;
    overflow-wrap: break-word;
    max-height: 30vh;
    font-size: 14px;
  }
  
  /* Touch-friendly elements */
  .touch-target {
    @apply min-h-[44px] min-w-[44px] touch-manipulation;
  }
  
  .touch-button {
    @apply min-h-[44px] min-w-[44px] touch-manipulation;
    @apply transition-all duration-200;
  }
  
  /* Safe area utilities */
  .safe-area-pb {
    padding-bottom: env(safe-area-inset-bottom);
  }
  
  .safe-area-pt {
    padding-top: env(safe-area-inset-top);
  }
  
  .safe-area-pl {
    padding-left: env(safe-area-inset-left);
  }
  
  .safe-area-pr {
    padding-right: env(safe-area-inset-right);
  }
  
  /* Scrollbar hiding */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  
  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }
  
  /* Text size optimization for mobile */
  .text-mobile-sm {
    font-size: 12px;
    line-height: 1.4;
  }
  
  .text-mobile-base {
    font-size: 14px;
    line-height: 1.5;
  }
  
  .text-mobile-lg {
    font-size: 16px;
    line-height: 1.5;
  }
  
  /* Responsive text hiding */
  .text-hide-mobile {
    @apply hidden xs:inline;
  }
  
  .text-hide-small {
    @apply hidden mobile-lg:inline;
  }

  /* Мобильная оптимизация для аналитики */
  .analytics-container {
    @apply w-full max-w-none sm:max-w-3xl lg:max-w-4xl xl:max-w-6xl mx-auto;
    @apply px-3 sm:px-4 lg:px-6;
  }
  
  .analytics-content-spacing {
    @apply space-y-4 sm:space-y-6;
  }
  
  /* Мобильная типографика */
  .mobile-heading-primary {
    @apply text-xl sm:text-2xl lg:text-3xl font-bold leading-tight;
  }

  .mobile-heading-secondary {
    @apply text-lg sm:text-xl lg:text-2xl font-semibold leading-snug;
  }

  .mobile-text-body {
    @apply text-base sm:text-base leading-relaxed;
  }

  .mobile-text-small {
    @apply text-sm sm:text-base leading-relaxed;
  }

  /* Мобильная оптимизация для ИИ доктора */
  .ai-doctor-mobile-header {
    @apply p-2 sm:p-4 border-b bg-card/50 backdrop-blur-sm;
    @apply safe-area-pt;
  }

  .ai-doctor-mobile-messages {
    @apply flex-1 overflow-y-auto p-2 sm:p-4;
    @apply space-y-2 sm:space-y-4;
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
  }

  .ai-doctor-mobile-message {
    @apply flex items-start space-x-2 sm:space-x-3 w-full;
  }

  .ai-doctor-mobile-avatar {
    @apply w-6 h-6 sm:w-8 sm:h-8 border flex items-center justify-center flex-shrink-0;
  }

  .ai-doctor-mobile-content {
    @apply flex-1 min-w-0;
  }

  .ai-doctor-mobile-meta {
    @apply flex items-center space-x-1 sm:space-x-2 mb-1 sm:mb-2;
  }

  .ai-doctor-mobile-text {
    @apply text-xs sm:text-sm text-foreground leading-relaxed whitespace-pre-wrap break-words;
  }

  .ai-doctor-mobile-input {
    @apply p-2 sm:p-4 border-t bg-card/50 backdrop-blur-sm;
    @apply safe-area-pb;
  }

  .ai-doctor-mobile-textarea {
    @apply w-full min-h-[36px] sm:min-h-[44px] p-2 sm:p-4 resize-none border border-input bg-background rounded-md;
    @apply text-xs sm:text-sm placeholder:text-muted-foreground overflow-hidden;
    line-height: 1.4;
    word-break: break-word;
    overflow-wrap: break-word;
    max-height: 25vh;
  }

  .ai-doctor-mobile-button {
    @apply h-[36px] w-[36px] sm:h-[44px] sm:w-[44px] p-0 flex-shrink-0;
  }

  .ai-doctor-mobile-suggestions {
    @apply p-2 sm:p-4 border-b border-border;
  }

  .ai-doctor-mobile-suggestion-btn {
    @apply h-auto p-2 sm:p-3 text-left justify-start hover:bg-muted/50 w-full;
  }

  .ai-doctor-mobile-suggestion-icon {
    @apply w-4 h-4 sm:w-5 sm:h-5 bg-primary text-primary-foreground border border-primary;
    @apply flex items-center justify-center flex-shrink-0;
  }

  .ai-doctor-mobile-suggestion-text {
    @apply text-xs sm:text-sm font-medium text-foreground leading-snug;
  }
  
  /* Мобильные карточки */
  .mobile-card {
    @apply p-4 sm:p-5 lg:p-6 rounded-lg border bg-white shadow-sm;
  }
  
  .mobile-card-header {
    @apply pb-3 sm:pb-4;
  }
  
  .mobile-card-content {
    @apply pt-0 p-4 sm:p-5 lg:p-6;
  }
  
  /* Touch targets для мобильных */
  .mobile-touch-target {
    @apply min-h-[44px] min-w-[44px] touch-manipulation;
  }
  
  .mobile-button {
    @apply px-4 py-3 text-base font-medium rounded-lg min-h-[44px] min-w-[44px];
    @apply transition-all duration-200 touch-manipulation;
  }
  
  .mobile-button-sm {
    @apply px-3 py-2 text-sm font-medium rounded-md min-h-[40px] min-w-[40px];
  }
  
  /* Мобильные badge */
  .mobile-badge {
    @apply px-3 py-1.5 text-sm font-medium rounded-full;
  }
  
  .mobile-badge-sm {
    @apply px-2 py-1 text-xs font-medium rounded-full;
  }
  
  /* Responsive grids для мобильных */
  .analytics-grid {
    @apply grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4 lg:gap-6;
  }
  
  .analytics-goals-grid {
    @apply grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4;
  }
  
  /* Мобильные отступы для рекомендаций */
  .recommendation-card-mobile {
    @apply border-l-4 hover:shadow-md transition-shadow;
    @apply p-4 sm:p-5 lg:p-6 space-y-3 sm:space-y-4;
  }
  
  .recommendation-header-mobile {
    @apply space-y-3 sm:space-y-4;
  }
  
  .recommendation-actions-mobile {
    @apply flex flex-col sm:flex-row gap-2 sm:gap-3 w-full sm:w-auto;
  }
  
  /* Флекс контейнеры для мобильных */
  .mobile-flex-header {
    @apply flex flex-col sm:flex-row items-start sm:items-center gap-3 sm:gap-4;
  }
  
  .mobile-flex-actions {
    @apply flex flex-col sm:flex-row gap-2 sm:gap-3 w-full sm:w-auto;
  }
  
  /* Отступы для контента */
  .mobile-section-spacing {
    @apply py-4 sm:py-6 lg:py-8;
  }
  
  .mobile-content-spacing {
    @apply space-y-4 sm:space-y-5 lg:space-y-6;
  }
}
