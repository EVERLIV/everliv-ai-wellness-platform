
import { HealthProfileData } from '@/hooks/useHealthProfile';
import { DetailedRecommendation } from '@/types/detailedRecommendations';

export const generatePersonalizedRecommendations = (healthProfile?: HealthProfileData): DetailedRecommendation[] => {
  const recommendations: DetailedRecommendation[] = [];

  if (!healthProfile) {
    recommendations.push({
      id: 'complete-profile',
      category: 'Профиль здоровья',
      title: 'Заполните профиль здоровья',
      priority: 'high',
      description: 'Для получения персональных рекомендаций необходимо заполнить детальный профиль здоровья',
      specificActions: [
        'Перейдите в раздел "Профиль здоровья"',
        'Заполните все обязательные поля',
        'Укажите текущие заболевания и принимаемые препараты',
        'Опишите образ жизни и физическую активность'
      ],
      expectedResult: 'Получение персональных рекомендаций по здоровью',
      timeframe: '15-20 минут',
      cost: 'Бесплатно'
    });
    return recommendations;
  }

  // Рекомендации по курению
  if (healthProfile.smokingStatus === 'regular' || healthProfile.smokingStatus === 'occasional') {
    recommendations.push({
      id: 'quit-smoking',
      category: 'Отказ от курения',
      title: 'План постепенного отказа от курения',
      priority: 'high',
      description: 'Курение значительно повышает риски для здоровья. Разработан поэтапный план отказа.',
      specificActions: [
        'Выберите дату отказа (через 2-4 недели)',
        'Снижайте количество сигарет на 25% каждую неделю',
        'Замените сигареты никотиновыми пластырями или жвачкой',
        'Избегайте триггерных ситуаций (алкоголь, стресс)',
        'Найдите альтернативные занятия (спорт, хобби)',
        'Обратитесь к наркологу для поддержки'
      ],
      expectedResult: 'Полный отказ от курения за 1-2 месяца',
      timeframe: '1-2 месяца',
      cost: '5,000-15,000₽ (никотинозаместительная терапия + консультации)'
    });
  }

  // Рекомендации по физической активности
  if (healthProfile.physicalActivity === 'sedentary' || healthProfile.exerciseFrequency < 3) {
    recommendations.push({
      id: 'increase-activity',
      category: 'Физическая активность',
      title: 'Программа постепенного увеличения активности',
      priority: 'medium',
      description: 'Недостаток движения влияет на все системы организма. План поэтапного увеличения нагрузки.',
      specificActions: [
        'Неделя 1-2: Ходьба 20 минут каждый день',
        'Неделя 3-4: Добавить 2 силовые тренировки по 30 минут',
        'Неделя 5-8: Увеличить ходьбу до 40 минут, добавить растяжку',
        'Неделя 9-12: Полноценные тренировки 4-5 раз в неделю',
        'Использовать лестницу вместо лифта',
        'Делать перерывы на движение каждый час'
      ],
      expectedResult: 'Улучшение выносливости, снижение веса, повышение энергии',
      timeframe: '3 месяца',
      cost: '3,000-8,000₽/месяц (абонемент в спортзал)'
    });
  }

  // Рекомендации по питанию
  if (healthProfile.alcoholConsumption === 'heavy' || healthProfile.waterIntake < 6) {
    recommendations.push({
      id: 'improve-nutrition',
      category: 'Питание и гидратация',
      title: 'Нормализация питьевого режима и снижение алкоголя',
      priority: 'high',
      description: 'Правильная гидратация и умеренное потребление алкоголя критически важны для здоровья.',
      specificActions: [
        'Поставьте цель 8 стаканов воды в день',
        'Пейте стакан воды сразу после пробуждения',
        'Ограничьте алкоголь до 1-2 порций в неделю',
        'Замените сладкие напитки на воду с лимоном',
        'Ведите дневник потребления жидкости первые 2 недели',
        'При необходимости - консультация диетолога'
      ],
      expectedResult: 'Улучшение метаболизма, снижение нагрузки на печень, повышение энергии',
      timeframe: '4-6 недель',
      cost: '2,000-5,000₽ (консультация диетолога)'
    });
  }

  // Рекомендации по сну и стрессу
  if (healthProfile.sleepHours < 7 || healthProfile.stressLevel > 6) {
    recommendations.push({
      id: 'improve-sleep-stress',
      category: 'Сон и стресс',
      title: 'Программа нормализации сна и управления стрессом',
      priority: 'high',
      description: 'Хронический стресс и недосыпание подрывают иммунитет и ускоряют старение.',
      specificActions: [
        'Ложитесь спать в одно время (до 23:00)',
        'Создайте ритуал перед сном (чтение, медитация)',
        'Исключите экраны за 1 час до сна',
        'Практикуйте дыхательные упражнения 10 минут утром',
        'Попробуйте медитацию или йогу',
        'При необходимости - консультация психолога'
      ],
      expectedResult: 'Улучшение качества сна, снижение уровня стресса, повышение концентрации',
      timeframe: '2-4 недели',
      cost: '3,000-6,000₽ (консультации специалистов)'
    });
  }

  // Рекомендации по возрасту
  if (healthProfile.age > 40) {
    recommendations.push({
      id: 'age-prevention',
      category: 'Возрастная профилактика',
      title: 'Программа профилактики возрастных изменений',
      priority: 'medium',
      description: 'После 40 лет важно усилить профилактические меры для поддержания здоровья.',
      specificActions: [
        'Пройдите комплексное обследование (кардиолог, эндокринолог)',
        'Сдайте расширенные анализы крови',
        'Начните принимать витамин D и Омега-3',
        'Увеличьте потребление антиоксидантов (ягоды, зеленый чай)',
        'Регулярно проверяйте артериальное давление',
        'Планируйте ежегодные профосмотры'
      ],
      expectedResult: 'Раннее выявление и профилактика возрастных заболеваний',
      timeframe: 'Постоянно',
      cost: '15,000-25,000₽/год (обследования и добавки)'
    });
  }

  // Базовые рекомендации для всех
  recommendations.push({
    id: 'basic-health',
    category: 'Базовая профилактика',
    title: 'Ежедневные привычки для здоровья',
    priority: 'medium',
    description: 'Простые, но эффективные ежедневные практики для поддержания здоровья.',
    specificActions: [
      'Выпивайте стакан воды утром натощак',
      'Делайте 10-минутную зарядку каждое утро',
      'Съедайте минимум 3 порции овощей и фруктов в день',
      'Проводите 15 минут на свежем воздухе ежедневно',
      'Практикуйте благодарность (записывайте 3 хорошие вещи дня)',
      'Ограничьте время в социальных сетях до 1 часа в день'
    ],
    expectedResult: 'Улучшение общего самочувствия, повышение энергии и настроения',
    timeframe: '2-3 недели для формирования привычек',
    cost: 'Бесплатно'
  });

  return recommendations;
};
